# Глава 24. «Обличение»

«Ти, эти девчонки - белый мусор. Лучше не дружи с ними», - сказал Крис, - «Мозги у них другие».

Они сидели в "Наан и Карри", круглосуточном индийско-пакистанском ресторанчике в театральном районе Сан-Франциско. Это произошло спустя три месяца с того момента, когда Ти познакомилась с Крисом и была с ним в одной из его поездок в район Бухты, где он встречал своего таинственного друга-хакера "Сэма", как раз перед рассветом. Они были всего в четырех кварталах от безопасного дома Криса, но Ти до сих пор не была представлена хакеру - ни сейчас, ни до этого. Никто не встречался с Сэмом лично.

Она была очарована тем как все это работало: безналичная природа преступлений и способ, которым Крис организовал свою команду. Он рассказал ей все, когда решил, что она готова, но он никогда не просил ее совершать покупки в магазинах, как остальных. Она была особенной. Он даже не любил болтаться с ней и со своей командой обналичивания одновременно, из опасения, что они как-то могут навредить ей.

Ти также была единственным работником, которому не платят. После того как она отказалась от 40 баксов, оставленных Крисом на ночном столике, он решил, что Ти не возьмет от него никаких денег, несмотря на долгие часы, которые она проводила на Рынке Кардеров и на Русских досках объявлений для преступлений. Крис заботился об аренде дома Ти, покупал ей одежду и оплачивал ее путешествия, но она все же находила такое существование немного странным: жизнь онлайн, путешествия с помощью подтверждений, а не билетов на самолеты. Она стала призраком, ее тело находилось в Оранжевой стране, а разум чаще всего проецировался в Украину и Россию, оказывая поддержку главарям организованной киберпреступности в роли эмиссара Iceman - т.е. мира кардеров Запада.

Она решила, что Iceman был приятно холоден к ней. Он всегда был уважительным и дружелюбным. Когда Крис и его партнер ушли на одно из своих сражений, каждый человек начал скулить и сплетничать Ти о других через ICQ, прямо как дети. С какого-то момента Iceman наговорил ей кучу дерьма и предложил ей уйти в свой собственный бизнес, такой шаг заставил Криса раздражительно попсиховать.

Как-то Крис и Ти болтались в индийской забегаловке; с улицы зашел высокий человек с косичкой и проследовал в глубину зала к кассе, его глаза скользнули по ним всего на мгновение, прежде чем он забрал сумку на вынос и исчез. Крис улыбнулся: "Это был Сэм."

Возвращаясь в Оранжевую страну: произведенных фальшивых операций Криса было достаточно, чтобы отправить его детей в частные школы, покрыть апартаменты Ти и в июле начать искать большое и хорошее жилье ему и его семье. Он отправился на поиски дома с Дженноном и в прибрежном городке Капистрано-Бич нашел сдающийся в аренду просторный двухэтажный дом, возвышающийся на утесе над песчаным пляжем в конце тихого дорожного тупика. Там были дружелюбные соседи, висящие над гаражами баскетбольные кольца, и пришвартованная к соседнему причалу лодка. Переезд был назначен на 15 июля.

Дженнон летел обратно на праздники в честь 4 Июля - последний праздник Криса в его старых апартаментах - но вынужден был вернуться назад в дом Ти, пока Крис проводил время с семьей. Это происходило все время; Дженнон должен был лететь в аэропорт Джона Уэйна, рассчитывая потусить в клубах с Крисом, а вместо этого он вынужден был либо скрываться с одной команд, либо побыть нянькой мальчиков Криса у него дома. Ти была довольно терпимой, в отличие от той части дешевых девчонок, обналичивающих карты Криса, но время в квартире Дана Пойнт просто-таки тянулось.

Он позвонил Крису и пожаловался, что ему скучно. "Приходи к дому," - сказал Крис, они были в бассейне, - "Жена здесь с детьми."

Дженнон пригласил Ти, которая никогда не видела гостиничного комплекса Криса, расположенного всего в четырех милях от нее. Когда они пришли, Крис, Клара и пара мальчиков плескались в бассейне, наслаждаясь солнышком. Дженнон и Ти сказали привет и расположились на шезлонгах у дома.

Крис остолбенел. "Я смотрю ты привел свою подругу," - раздраженно сказал он Дженнону.

Клара знала Дженнона, сиделку, но никогда не видела Ти. Она глянула на незнакомку, потом на Дженнона, затем снова на монголку, и тут осознание и гнев перекосили ее лицо.

До Дженнона дошло, что он сделал глупость. Обе женщины выглядели странно похожими. Ти была молодой версией жены Криса, и, судя по первому взгляду, Клара знала, что ее муж спал с этой женщиной.

Крис вытащил себя из бассейна и с нейтральным лицом прогулялся до места где они расположились. Он присел на корточки перед Дженноном, вода с его волос капала на бетон. "Ты что творишь?" - тихим голосом произнес он: "Валите отсюда."

Они ушли. Впервые, с того момента как она присоединилась к Крису Арагону и его банде, Ти почувствовала себя грязной.

Крис не злился - да он виновен, но он наслаждался как альфа-самец от зрелища Ти и Клары в одном месте. Но все же увлечение Ти становилось проблемой. Он в самом деле по настоящему привязался к ней и ее необычным привычкам, но она становилась нежелательным осложнением.

Он нашел идеальный выход из своего положения. Он просто купил ей билет на самолет в длительный отпуск на ее родину: буквально прогнал свою пламенную любовницу во Внешнюю Монголию.

Пока Крис отвлекался на свою запутанную любовную жизнь, Cardersmarket потреблял все больше времени Макса, он все еще вел свои дела в роли "Digits", бегая. Сейчас он работал в индустрии общественного питания, и это с лихвой окупалось.

Это началось в июне 2006, когда появилась серьезная дыра в безопасности в программном коде RealVNC, "виртуальной сетевой консоли" - программы для удаленного контроля, используемой, чтобы администрировать Windows машины через Интернет.

Ошибка была в короткой процедуре рукопожатия, которая предшествовала каждому установлению новой сессии между VNC клиентом и RealVNC сервером. Критичная часть процедуры рукопожатия наступала, когда сервер и клиент согласовывали тип безопасности применяемый к сессии. Это двухступенчатое рукопожатие. Для начала RealVNC сервер посылал клиенту сокращенный список настроенных для поддержки протоколов безопасности. Список - это просто массив чисел: например, [2, 5] означает, что сервер VNC поддерживает второй тип безопасности, относительно простая парольная схема аутентификации, и тип 5, полностью зашифрованное соединение.

На втором этапе клиент говорил серверу, какой из объявленных протоколов безопасности он хочет использовать, посылая обратно соответствующий номер, как заказ Китайской еды в меню.

Проблема была в том, что RealVNC сервер в первую очередь не сверял ответ от клиента, чтобы узнать был ли он в предоставленном меню. Клиент мог послать обратно любой тип безопасности, даже тот который сервер не объявлял, и сервер безоговорочно принимал его. Даже включая тип 1, который почти никогда не объявлялся, потому что тип 1 означал отсутствие безопасности полностью, это позволяло вам залогиниться в RealVNC без пароля.

Изменить клиент VNC, заставив всегда отсылать тип 1, превращая его в отмычку, было плевым делом. Такой злоумышленник, как Макс мог навести свой взломанный софт на любую коробку с запущенным уязвимым RealVNC и мгновенно насладиться беспрепятственным доступом к машине.

Макс приступил к сканированию на уязвимые инсталляции RealVNC, как только он узнал об этой зияющей дыре. Он ошеломленно наблюдал, как результаты заполняли его экран все ниже и ниже, их были тысячи: компьютеры в домах и в общежитиях колледжей, машины офисов Western Union, банков и вестибюлей гостиниц. Он залогинился наугад в один; и обнаружил себя смотрящим на коридоры через камеры видеонаблюдения, находящиеся в вестибюле замкнутого офисного здания. Другой компьютер был из департамента полиции Среднего Запада, где он мог послушать звонки в 911. Третий перенес его к владельцу дома с системой климат контроля, он поднял температуру на десять градусов и двинулся дальше.

Крошечная часть из всех систем была более интересной и также знакомой благодаря его продолжающемуся вторжению в Pizza Schmizza. Это были ресторанные системы обслуживания. Это были деньги.

В отличие от простых и тупых терминалов, сидящих на прилавках винных магазином и бакалейных лавок, ресторанные системы становились более сложными решениями все-в-одном, которые поддерживали все: начиная с приема заказа и заканчивая рассадкой мест, и все они были под управлением Microsoft Windows. Чтобы поддерживать машины удаленно, поставщики услуг устанавливали их с коммерческими бэкдорами, включая VNC. Со своей отмычкой для VNC Макс мог по желанию открыть многие из них.

Итак, Макс, который однажды сканировал всю военную сеть США, ища уязвимые сервера, теперь целыми днями и ночами фишил своими компьютерами в Интернете, ища и взламывая пиццерии, итальянские рестораны, французские бистро и американские гриль-бары, - он собирал данные с магнитных полос кредиток отовсюду, где их находил.

В соответствии со стандартами безопасности Visa это не должно быть возможным. В 2004 компаниям запретили использовать любые точки продаж, которые сохраняют данные магнитных полос кредиток после завершения транзакций. Чтобы соответствовать стандартам, все основные поставщики сделали патчи, которые позволяют остановить их системы от сохранения данных магнитных полос.

В технике сканирования Макса было несколько взаимодействующих частей. Первая была направлена на поиск установленных VNC, используя быстрый проход "зачистку портов" - стандартный метод разведки, который полагается на открытость интернета и стандартов.

С самого начала сетевые протоколы интернета были разработаны, чтобы позволить компьютерам совмещать различные типы соединений одновременно - сегодня они могут включать в себя электронную почту, веб-трафик, передачу файлов и сотню других более экзотических сервисов. Чтобы поддерживать все это раздельно, компьютеры устанавливают новые соединения с помощью двух информационных частей: IP адрес машины назначения и виртуальный "порт" на ней же - число от 0 до 65535 - который идентифицирует тип сервиса для требуемого соединения. IP адрес похож на телефонный номер, а порт похож на добавочный номер, который вы вбиваете в коммутатор компании, и потому он может отправить ваш звонок в нужный отдел.

Номера портов стандартизированы и опубликованы онлайн. Софт электронной почты знает, что порт для отправки сообщения 25, веб-браузеры соединяются с 80 портом, чтобы попасть на веб-сайт. Если в соединении на специфичном порту отказано, то это как вызов без ответа, значит сервиса, который вы ищете, нет на этом IP адресе.

Макс интересовался 5900 портом - стандартным портом для VNC сервера. Он настроил свои машины шерстить широкое адресное пространство Интернета, посылая на каждый адрес всего один шестидесяти четырех байтный пакет синхронизации, который проверял, был ли порт 5900 открыт для сервиса.

Адреса, которые отвечали на его фишинг, передавались написанному Максом PERL скрипту, который подключался к каждой машине и пытался залогиниться, используя ошибку в RealVNC. Если эксплоит не срабатывал, скрипт пытался использовать общие пароли: 1234, vnc или пустую строку.

Если он попадал внутрь, программа вытаскивала некую предварительную информацию о компьютере: название машины, а также разрешение и глубину цветов монитора. Макс пренебрегал компьютерами с низким качеством дисплеев, предполагая, что они были домашними компьютерами, а не для бизнеса. Эта операция была очень быстрой: Макс запустил ее на пяти или шести серверах сразу, каждый из которых просматривал сеть класса B, около шестидесяти пяти тысяч адресов, за пару секунд. Таким образом его список установленных уязвимых VNC рос примерно на десять тысяч записей каждый день.

Системы точек продаж были иголками в огромном стоге сена. Он мог определить несколько просто из названия: "Aloha" означает скорее всего терминал Aloha POS, произведенный в Атланте на базе системы от Radiant Systems, его излюбленной цели; "Maitre'D" был конкурирующим продуктом от Posera Software из Сиэтла. Для остальных же требовалось догадываться. Любая машина с названием "Server", "Admin" или "Manager" требовала повторного взгляда.

Проскальзывая через свой VNC клиент, Макс мог видеть экран компьютера, как если бы он сидел перед ним. Т.к. он работал ночью, дисплей бездействующего PC был обычно темным, потому он не навязчиво толкал мышь, останавливая тем самым заставку. Если же кто-то был в комнате рядом, это могло выглядеть немного жутковато: помните то время, когда монитор вашего компьютера загорался без причины, а курсор дергался? Это мог быть Макс Вижн, быстро кидающий взгляд на ваш экран.

Эта часть проверки была медленной. Макс нанял Ти помогать - он дал ей VNC клиент и начал скармливать ей списки уязвимых машин, заодно скинув инструкции по тому, что надо искать. Вскоре Макс был подключен к закусочным по всей Америке. Бургер Кинг в Техасе. Спорт-бар в Монтане. Модный ночной клуб во Флориде. Калифорнийский гриль-бар. Он двинулся в Канаду и нашел еще больше.

Макс начинал свои продажи краденных дампов с одного единственного ресторана. Теперь же у него было целых сто, подающих ему данные кредитных карт почти в реальном времени. У Digits будет намного больше работы.

С таким большим объемом работы Дэйв "Эль Мариачи" Томас выбрал плохое время, чтобы стать настоящей болью в заднице Iceman'а. В июне Томас сделал что-то почти неслыханное в узком кругу компьютерного подполья: он вынес беседы с форумов на публику, в обычное киберпространство, атакуя таким образом Cardersmarket в комментариях широко читаемого блога по компьютерной безопасности, где он обвинял Iceman'а в связи с "ОП" (органами правопорядка).

"Вот сайт, размещенный в Форт-Лодердейле, штат Флорида," - писал Томас, - "Фактически он расположен в чьем-то доме. Тем не менее ОП отказывается закрыть их. Несмотря на то, что этот сайт продает PIN коды и номера PayPal, eBay и так далее, ОП все это время смотрит на других игроков."

"ОП утверждают, что они ничего не могут сделать с сайтом размещенным на территории США. Но, по правде говоря, ОП сами запустили этот сайт точно также, как они это сделали с Shadowcrew."

Подчеркивая договоренности размещения Рынка Кардеров, Томас целился в Ахиллесову пяту Iceman'а. Сайт до сих пор продолжал мирно мурлыкать потому, что в компании Affinity до сих пор не замечали незаконный сервер среди десяти тысяч своих законных сайтов. Эль работал над тем, чтобы изменить такой расклад, снова и снова подавая жалобы в компанию. Такой тактике не доставало логики: если Cardersmarket действительно был под контролем правительства, то жалобы летели в глухие уши; только если бы это был по-настоящему преступный сайт, Affinity бы его удалила. Если бы Iceman утонул, это бы значило что он не ведьма.

Неделю спустя после поста Томаса, Affinity резко обрубила Cardersmarket. Закрытие рассердило Макса, у него бы была хорошая штука в ValueWeb. Ну что ж, ему пришлось искать новый зарубежный легитимный хостинг, который мог быть противопоставлен Эль Мариачи, в компаниях, находящихся в Китае, России, Индии и Сингапуре. Это всегда выходило одинаково - они б запросили немного денег авансом как стоимость входа, а потом бы раскатали красную ленточку перед парадной дверью, при этом спросив паспорт и лицензию на предпринимательскую деятельность или корпоративные документы.

«Это не прокатит потому, что у тебя немного ИДИОТСКИ ТУПОЕ НАЗВАНИЕ, говорящее «здесь КАРДЕРЫ» или «это РЫНОК КАРДЕРОВ». Ну так что, возможно?» - писал Томас, дразня Iceman'а, - «Может если б ты не кричал «ЗДЕСЬ РАБОТАЮТ КАРДЕРЫ», то ты мог бы иметь маленький работающий сайт с возможностью его дальнейшего роста до того монстра, в котором ты отчаянно нуждаешься.»

Сейчас это было личным: Томас ненавидел Iceman'а, независимо был ли он федералом или нет, и это чувство становилось взаимным.

Наконец, Макс забрался в Staminus, Калифорнийскую фирму, специализирующуюся на хостинге с высокой пропускной способностью для защиты от DDoS атак. К тому времени Томас рвал и метал в него в комментариях одного случайного блога под названием "Жизнь на Дороге." Блогер процитировал комментарии Томаса о Рынке Кардеров в краткой заметке о форумах, невольно превращая свой блог в новое поле боя в войне Эль Мариачи против Iceman.

Iceman подобрал перчатку и разместил длинное публичное опровержение против осуждений Томаса, обвиняя своего врага в "лицемерии и клевете".

> CM - не "доска объявлений для преступности" или "империя", или любая другая подобная этой обвиняемая всеми ерунда. Мы просто форум, который выбрал возможность позволить обсуждать финансовые преступления. Мы также предоставляем право в суждении, кто из участников настоящий, а кто подделка, но все это только наши мнения, мы не делаем на этом денег. Мы только НОСИТЕЛЬ информации, мы ФОРУМ, через который эта связь может проходить без притеснений. CM вообще не вовлечен ни в какие преступления. Управлять форумом и позволять обсуждать не является незаконным.
>
> На craigslist.com есть личности, дающие объявления о проституции, наркотических соединениях и других очевидных преступлениях, но люди пока не зовут craigslist "универсальным магазином шлюх и драгдилеров" или преступной империей. Он расценивается как НОСИТЕЛЬ, который не отвечает за содержание постов на нем. Такова позиция Рынка Кардеров.

Смелая оборона полностью игнорировала факт наличия на Рынке Кардеров детальных руководств к преступлениям и обзоров систем, не говоря уже о скрытой составляющей сайта: дающей Максу площадку для продаж украденных данных.

Зная что его Калифорнийский хостинг не удовлетворит подполье, Макс продолжил свои поиски за рубежом. Уже в следующем месяце он взломал для себя новый сервер, на этот раз в стране, которая была настолько далеко от США, как никто другой в Сети; в стране, которая вряд ли ответит на жалобы Дэйва Томаса или даже Американского правительства.

"Cardersmarket теперь находится в ИРАНЕ," - 11 августа объявил он, - "Регистрация возобновлена."
